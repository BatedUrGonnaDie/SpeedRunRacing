= provide(:title, "#{@race.game.name} - #{@race.category.name}")
- user_active = @race.contains_user?(current_user)
- race_progress = @race.in_progress?
- current_entrant = @race.entrant_for_user(current_user)
- cur_en_ready = current_entrant.try(:ready)
.col-md-6
  %h4
    = link_to "#{@race.game.name}", game_path(@race.game)
    = " - #{@race.category.name}"
.col-md-1
  %button.btn.btn-success.btn-join-race{class: user_active && !race_progress ? 'hidden' : 'show', disabled: race_progress}
    Join Race
  %button.btn.btn-danger.btn-part-race{class: user_active && !race_progress ? 'show' : 'hidden'}
    Part Race
  %button.btn.btn-danger.btn-abandon-race{class: race_progress ? 'show' : 'hidden'} Abandon Race
.col-md-1
  %button.btn.btn-success.btn-ready-race{class: cur_en_ready && !race_progress ? 'hidden' : 'show', disabled: !current_entrant.present?}
    Ready Up
  %button.btn.btn-danger.btn-unready-race{class: cur_en_ready && !race_progress ? 'show' : 'hidden'}
    Unready
  %button.btn.btn-success.btn-done-race{class: race_progress ? 'show' : 'hidden'} Done!

.col-md-4
  #entrants-list
    %table.table.table-hover
      %thead
        %tr
          %th Entrants
          %th Ready?
          %th Time
          %th Place
      %tbody
        - @race.entrants.each do |e|
          %tr{id: "entrant-id-#{e.id}"}
            %td.name-column
              = e.user.display_name
            %td.ready-column
              %i.glyphicon{class: e.ready ? 'glyphicon-ok text-success' : 'glyphicon-remove text-danger'}
            %td.time-column
              .format-time
                = e.finished? ? e.duration : '-'
            %td.place-column
              .format-place
                = e.place.present? ? e.place : '-'
